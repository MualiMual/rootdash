<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Dashboard</title>
    <link href="https://vjs.zencdn.net/7.15.4/video-js.css" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <!-- Header Bar -->
    <div class="header">
        <!-- Left Side: Home Dashboard and IP Address -->
        <div class="header-left">
            <h1>Home Dashboard</h1>
            <div id="ip-address">IP: Loading...</div>
        </div>

        <!-- Right Side: Date and Time -->
        <div id="datetime">Loading time...</div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Jumbo Container (60% width) -->
        <div class="left-jumbo">
            <!-- Video Feeds Section -->
            <div class="video-feeds">
                <div class="video-feed">
                    <!-- Live Weather Map -->
                    <div class="weather-map">
                        <iframe src="https://www.rainviewer.com/map.html?loc=42.3223,-83.1763,8&oFa=0&oC=0&oU=0&oCS=1&oF=0&oAP=0&c=1&o=83&lm=1&layer=radar&sm=1&sn=1" allowfullscreen></iframe>
                    </div>
                </div>
                <div class="video-feed">
                    <img src="{{ url_for('video_feed') }}" alt="Video Feed">
                    <!-- Snapshot Button -->
                    <button class="snapshot-button" onclick="takeSnapshot()">Snapshot</button>
                </div>
            </div>

            <!-- Horizontal Rule -->
            <hr />

            <!-- Sensor Widgets Section -->
            <div class="sensor-widgets">
                <div class="widget">
                    <h2>Power</h2>
                    <p id="analog-value">N/A</p>
                </div>
                <div class="widget">
                    <h2>Light</h2>
                    <p id="color-red">N/A</p>
                </div>
                <div class="widget">
                    <h2>Motion</h2>
                    <p id="accel-x">N/A</p>
                </div>
                <div class="widget">
                    <h2>Pressure</h2>
                    <p id="pressure">N/A</p>
                </div>
                <div class="widget">
                    <h2>Temperature</h2>
                    <p id="temperature-sht">N/A</p>
                </div>
            </div>

            <!-- Horizontal Rule -->
            <hr />

            <!-- System Sensors Section -->
            <div class="system-sensors">
                <div class="widget">
                    <h2>CPU Usage</h2>
                    <p id="cpu-usage">N/A</p>
                </div>
                <div class="widget">
                    <h2>RAM Usage</h2>
                    <p id="ram-usage">N/A</p>
                </div>
                <div class="widget">
                    <h2>Storage Usage</h2>
                    <p id="storage-usage">N/A</p>
                </div>
            </div>
        </div>

        <!-- Right Jumbo Container (40% width) -->
        <div class="right-jumbo">
            <!-- 4-Box Layout -->
            <div class="four-box-layout">
                <!-- Top Left: Detection Insights -->
                <div class="box" id="detection-insights-box">
                    <h3>Detection Insights</h3>
                    <div id="detection-insights">
                        <!-- Dynamic content will be added here -->
                    </div>
                </div>

                <!-- Top Right: Last 5 Detections -->
                <div class="box">
                    <h3>Last 5 Detections</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Label</th>
                                <th>Confidence</th>
                            </tr>
                        </thead>
                        <tbody id="detections-table-body">
                            <!-- Detections will be dynamically added here -->
                        </tbody>
                    </table>
                </div>

                <!-- Bottom Left: Growth Rate -->
                <div class="box">
                    <h3>Growth Rate</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Plant</th>
                                <th>Rate</th>
                                <th>Height</th>
                            </tr>
                        </thead>
                        <tbody id="growth-rate-table-body">
                            <!-- Growth rate data will be dynamically added here -->
                        </tbody>
                    </table>
                </div>

                <!-- Bottom Right: Growth Graph -->
                <div class="box">
                    <h3>Growth Graph</h3>
                    <img id="growth-graph" src="" alt="Growth Graph" style="width: 100%; height: auto;">
                </div>

                <!-- New Widget: Seasonal Status -->
                <div class="box">
                    <h3>Seasonal Status</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Plant Name</th>
                                <th>Start Date</th>
                                <th>Harvest Date</th>
                                <th>Current Stage (%)</th>
                            </tr>
                        </thead>
                        <tbody id="seasonal-status-table-body">
                            <!-- Seasonal status data will be dynamically added here -->
                        </tbody>
                    </table>
                </div>

                <!-- New Widget: Harvest Scheduler -->
                <div class="box">
                    <h3>Harvest Scheduler</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Plant Name</th>
                                <th>Predicted Harvest Date</th>
                            </tr>
                        </thead>
                        <tbody id="harvest-scheduler-table-body">
                            <!-- Harvest scheduler data will be dynamically added here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
    <script src="https://vjs.zencdn.net/7.15.4/video.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/videojs-flash@2.2.1/dist/videojs-flash.min.js"></script>
    <script>
        var player = videojs('future-camera-feed', {
            techOrder: ['flash', 'html5'], // Use Flash for RTMP
            controls: true,
            autoplay: true,
            fluid: true
        });
    </script>
</body>
</html>